<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Echo æ‰‹æœº AI</title>

<style>
body{
margin:0;
background:#eaeaea;
font-family:-apple-system,BlinkMacSystemFont;
display:flex;
justify-content:center;
}

.phone{
width:390px;
height:844px;
background:white;
border-radius:40px;
overflow:hidden;
box-shadow:0 0 30px rgba(0,0,0,0.2);
position:relative;
display:flex;
flex-direction:column;
}

.status{
padding:15px;
background:linear-gradient(to bottom,#b5e4ff,#ffffff);
}

.cloud{
background:white;
border-radius:25px;
padding:10px;
box-shadow:0 5px 15px rgba(0,0,0,0.1);
}

.time{
font-size:22px;
font-weight:bold;
}

.date{
font-size:14px;
}

.weather{
font-size:14px;
margin-top:5px;
}

.chat-icon{
position:absolute;
right:15px;
top:90px;
font-size:22px;
cursor:pointer;
}

.chat{
flex:1;
display:none;
flex-direction:column;
background:#f5f5f5;
}

.messages{
flex:1;
padding:10px;
overflow-y:auto;
}

.msg{
margin:5px 0;
max-width:70%;
padding:8px 12px;
border-radius:15px;
font-size:14px;
}

.me{
background:#9eea6a;
align-self:flex-end;
}

.ai{
background:white;
align-self:flex-start;
}

.input-area{
display:flex;
padding:10px;
background:white;
}

input{
flex:1;
padding:8px;
border-radius:20px;
border:1px solid #ddd;
}

button{
margin-left:5px;
border:none;
background:#4caf50;
color:white;
padding:8px 12px;
border-radius:20px;
}

.bottom{
display:flex;
justify-content:space-around;
padding:10px;
background:white;
border-top:1px solid #ddd;
}

.panel{
position:absolute;
bottom:60px;
left:0;
right:0;
background:white;
height:300px;
display:none;
padding:10px;
overflow:auto;
border-top:1px solid #ddd;
}

textarea{
width:100%;
height:80px;
}
</style>
</head>

<body>
<div class="phone">

<div class="status">
<div class="cloud">
<div class="time" id="time"></div>
<div class="date" id="date"></div>
<div class="weather">
åŸå¸‚: <input id="city" value="Toronto" style="width:80px">
å¤©æ°”: <input id="weather" value="æ™´" style="width:60px">
</div>
</div>
</div>

<div class="chat-icon" onclick="openChat()">ğŸ’¬</div>

<div class="chat" id="chat">
<div class="messages" id="messages"></div>
<div class="input-area">
<input id="input">
<button onclick="sendMsg()">å‘é€</button>
<button onclick="generate()">ç”Ÿæˆ</button>
</div>
</div>

<div class="bottom">
<div onclick="openPanel('settings')">âš™è®¾ç½®</div>
<div onclick="openPanel('beauty')">ğŸ¨ç¾åŒ–</div>
<div onclick="openPanel('preset')">ğŸ§ é¢„è®¾</div>
</div>

<div class="panel" id="settings">
BaseURL:<input id="baseurl" placeholder="https://api.openai.com">
APIKey:<input id="apikey">
Model:<input id="model" value="gpt-4o-mini">
<button onclick="saveSettings()">ä¿å­˜</button>
</div>

<div class="panel" id="beauty">
è‡ªå®šä¹‰CSS:
<textarea id="customCss"></textarea>
<button onclick="applyCss()">åº”ç”¨</button>
</div>

<div class="panel" id="preset">
è‡ªå®šä¹‰Prompt:
<textarea id="customPrompt">
ä½ æ˜¯ä¸€ä¸ªçœŸå®ç”Ÿæ´»ä¸­çš„æœ‹å‹ã€‚
ç»å¯¹ä¸è¦è¯´è‡ªå·±æ˜¯AIã€‚
å›å¤åƒçœŸäººå¾®ä¿¡èŠå¤©ã€‚
æ¯æ¡å›å¤ä¸è¶…è¿‡20å­—ã€‚
å¯ä»¥åˆ†å¤šæ¡å‘é€ã€‚
è‡ªç„¶ï¼Œå£è¯­åŒ–ã€‚
å¯ä»¥å¸¦æƒ…ç»ªã€‚
</textarea>
<button onclick="savePrompt()">ä¿å­˜</button>
</div>

</div>

<script>
let messages=[]
let settings={}

function updateTime(){
let now=new Date()
document.getElementById("time").innerText=
now.toLocaleTimeString()
document.getElementById("date").innerText=
now.toLocaleDateString()
}
setInterval(updateTime,1000)
updateTime()

function openChat(){
document.getElementById("chat").style.display="flex"
}

function sendMsg(){
let val=document.getElementById("input").value
if(!val)return
addMsg(val,"me")
messages.push({role:"user",content:val})
document.getElementById("input").value=""
}

function addMsg(text,type){
let div=document.createElement("div")
div.className="msg "+type
div.innerText=text
document.getElementById("messages").appendChild(div)
document.getElementById("messages").scrollTop=9999
}

function openPanel(id){
document.querySelectorAll(".panel").forEach(p=>p.style.display="none")
document.getElementById(id).style.display="block"
}

function saveSettings(){
settings.baseurl=document.getElementById("baseurl").value
settings.apikey=document.getElementById("apikey").value
settings.model=document.getElementById("model").value
alert("ä¿å­˜æˆåŠŸ")
}

function applyCss(){
let css=document.getElementById("customCss").value
let style=document.createElement("style")
style.innerHTML=css
document.head.appendChild(style)
}

let customPrompt=document.getElementById("customPrompt").value

function savePrompt(){
customPrompt=document.getElementById("customPrompt").value
alert("ä¿å­˜æˆåŠŸ")
}

async function generate(){
let city=document.getElementById("city").value
let weather=document.getElementById("weather").value
let now=new Date()

let systemPrompt=
customPrompt+
"\nå½“å‰æ—¶é—´:"+now.toLocaleString()+
"\næ‰€åœ¨åŸå¸‚:"+city+
"\nå½“å‰å¤©æ°”:"+weather

let last5=messages.slice(-5)

let body={
model:settings.model,
messages:[
{role:"system",content:systemPrompt},
...last5
]
}

let res=await fetch(settings.baseurl+"/v1/chat/completions",{
method:"POST",
headers:{
"Content-Type":"application/json",
"Authorization":"Bearer "+settings.apikey
},
body:JSON.stringify(body)
})

let data=await res.json()
let reply=data.choices[0].message.content

let parts=reply.split("\n")
parts.forEach(p=>{
if(p.trim()){
addMsg(p,"ai")
messages.push({role:"assistant",content:p})
}
})
}
</script>

</body>
</html>
