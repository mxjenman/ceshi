<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Mobile OS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style id="custom-style">
        body { background: #f0f0f0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
        .glass-card { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); border-radius: 24px; }
        .app-icon { width: 60px; height: 60px; background: white; border-radius: 15px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .chat-msg-user { background: #95ec69; border-radius: 6px 0 6px 6px; }
        .chat-msg-ai { background: white; border-radius: 0 6px 6px 6px; }
    </style>
</head>
<body class="h-screen overflow-hidden flex flex-col">

    <div id="home-screen" class="flex-1 p-6 flex flex-col items-center">
        
        <!-- é¡¶éƒ¨å°äº‘æœµï¼ˆç°åœ¨ä¸Šç§»30pxï¼‰ -->
        <div class="glass-card w-full p-6 text-center shadow-lg relative mb-12 mt-4"
             style="background: radial-gradient(circle at top, #ffffff, #e0f2fe); transform: translateY(-30px);">
            <div id="display-time" class="text-5xl font-light text-gray-800">00:00</div>
            <div id="display-date" class="text-sm text-gray-500 mt-1">1æœˆ1æ—¥ æ˜ŸæœŸä¸€</div>
            <div class="mt-4 flex justify-center gap-2 text-blue-600 font-medium" onclick="editWeather()">
                <span id="display-city">åŒ—äº¬</span> Â· <span id="display-weather">æ™´</span>
            </div>
        </div>

        <div class="grid grid-cols-4 gap-6 w-full px-4">
            
            <!-- å¾®ä¿¡å›¾æ ‡ï¼ˆå³ç§»240pxï¼‰ -->
           <div class="col-span-4 flex justify-end">
    <div class="flex flex-col items-center gap-1"
         onclick="openChat()">
        <div class="app-icon text-green-500 text-3xl">ğŸ’¬</div>
        <span class="text-xs text-gray-600">å¾®ä¿¡</span>
    </div>
</div>
                <div class="app-icon text-green-500 text-3xl">ğŸ’¬</div>
                <span class="text-xs text-gray-600">å¾®ä¿¡</span>
            </div>

        </div>

        <!-- åº•æ ï¼ˆä¿æŒä¸‹ç§»20pxï¼‰ -->
        <div class="mt-auto glass-card w-full py-4 px-8 flex justify-between items-center mb-4"
             style="transform: translateY(20px);">
            <button onclick="openModal('settings')" class="flex flex-col items-center">
                <span class="text-xl">âš™ï¸</span><span class="text-[10px]">è®¾ç½®</span>
            </button>
            <button onclick="openModal('beauty')" class="flex flex-col items-center">
                <span class="text-xl">ğŸ¨</span><span class="text-[10px]">ç¾åŒ–</span>
            </button>
            <button onclick="openModal('presets')" class="flex flex-col items-center">
                <span class="text-xl">ğŸ“‘</span><span class="text-[10px]">é¢„è®¾</span>
            </button>
        </div>
    </div>

    <!-- ä»¥ä¸‹æ‰€æœ‰ä»£ç ä¿æŒå®Œå…¨ä¸å˜ -->

    <div id="chat-screen" class="fixed inset-0 bg-[#ededed] hidden flex flex-col z-50">
        <div class="h-12 bg-[#ededed] flex items-center px-4 border-b border-gray-200">
            <button onclick="closeChat()" class="text-xl">ã€ˆ</button>
            <div class="flex-1 text-center font-bold">AI å¥½å‹</div>
            <div class="w-6"></div>
        </div>
        <div id="chat-flow" class="flex-1 overflow-y-auto p-4 space-y-4"></div>

        <div class="p-3 bg-[#f7f7f7] border-t flex flex-col gap-2">
            <div class="flex gap-2">
                <input id="chat-input" type="text" class="flex-1 border-none rounded bg-white px-3 py-2 outline-none" placeholder="è¾“å…¥æ¶ˆæ¯...">
                <button onclick="sendUserMsg()" class="bg-green-600 text-white px-4 py-2 rounded">å‘é€</button>
            </div>
            <button onclick="triggerAI()" id="gen-btn" class="w-full bg-blue-500 text-white py-1 rounded text-sm">ç‚¹å‡»ç”Ÿæˆå¯¹æ–¹å›å¤</button>
        </div>
    </div>

    <div id="modal-overlay" class="fixed inset-0 bg-black/50 hidden z-[60] flex items-center justify-center p-6">
        <div class="bg-white rounded-2xl w-full max-h-[80vh] overflow-y-auto p-6">
            <div id="modal-content"></div>
            <button onclick="closeModal()" class="mt-6 w-full py-3 bg-gray-100 rounded-xl font-bold">ç¡®å®šå¹¶ä¿å­˜</button>
        </div>
    </div>

<script>
let config = {
    baseUrl: 'https://api.openai.com/v1',
    apiKey: '',
    model: 'gpt-3.5-turbo',
    city: 'åŒ—äº¬',
    weather: 'æ™´',
    customCss: '',
    systemPrompt: 'ä½ æ˜¯ä¸€ä¸ªçœŸå®çš„å¾®ä¿¡å¥½å‹ï¼Œå›å¤æç®€ï¼Œæ§åˆ¶åœ¨20å­—å†…ã€‚'
};
let chatHistory = [];

/* JSé€»è¾‘å…¨éƒ¨ä¿æŒä¸å˜ */

function updateTime() {
    const now = new Date();
    document.getElementById('display-time').innerText =
        now.getHours().toString().padStart(2, '0') + ':' +
        now.getMinutes().toString().padStart(2, '0');
    const options = { month: 'long', day: 'numeric', weekday: 'long' };
    document.getElementById('display-date').innerText =
        now.toLocaleDateString('zh-CN', options);
}
setInterval(updateTime, 1000);
updateTime();

/* å…¶ä½™å‡½æ•°å®Œå…¨ä¿ç•™ */

function openModal(type){const content=document.getElementById('modal-content');document.getElementById('modal-overlay').classList.remove('hidden');if(type==='settings'){content.innerHTML=`<h2 class="text-xl font-bold mb-4">API è®¾ç½®</h2><p class="text-xs mb-1">Base URL</p><input id="cfg-url" class="w-full border p-2 mb-3 rounded" value="${config.baseUrl}"><p class="text-xs mb-1">API Key</p><input id="cfg-key" type="password" class="w-full border p-2 mb-3 rounded" value="${config.apiKey}"><p class="text-xs mb-1">æ¨¡å‹åç§°</p><input id="cfg-model" class="w-full border p-2 mb-3 rounded" value="${config.model}">`;}else if(type==='beauty'){content.innerHTML=`<h2 class="text-xl font-bold mb-4">UI ç¾åŒ– (CSS)</h2><textarea id="cfg-css" class="w-full border p-2 h-40 font-mono text-sm">${config.customCss}</textarea>`;}else if(type==='presets'){content.innerHTML=`<h2 class="text-xl font-bold mb-4">AI é¢„è®¾</h2><textarea id="cfg-prompt" class="w-full border p-2 h-40 text-sm">${config.systemPrompt}</textarea>`;}}
function closeModal(){if(document.getElementById('cfg-url')){config.baseUrl=document.getElementById('cfg-url').value;config.apiKey=document.getElementById('cfg-key').value;config.model=document.getElementById('cfg-model').value;}if(document.getElementById('cfg-css')){config.customCss=document.getElementById('cfg-css').value;document.getElementById('custom-style').innerHTML+=config.customCss;}if(document.getElementById('cfg-prompt')){config.systemPrompt=document.getElementById('cfg-prompt').value;}document.getElementById('modal-overlay').classList.add('hidden');}
function editWeather(){const c=prompt("è¾“å…¥åŸå¸‚",config.city);const w=prompt("è¾“å…¥å¤©æ°”",config.weather);if(c)config.city=c;if(w)config.weather=w;document.getElementById('display-city').innerText=config.city;document.getElementById('display-weather').innerText=config.weather;}
function openChat(){document.getElementById('chat-screen').classList.remove('hidden');}
function closeChat(){document.getElementById('chat-screen').classList.add('hidden');}
function sendUserMsg(){const input=document.getElementById('chat-input');if(!input.value)return;renderMsg(input.value,'user');chatHistory.push({role:'user',content:input.value});input.value='';}
function renderMsg(text,role){const container=document.getElementById('chat-flow');const div=document.createElement('div');div.className=`flex ${role==='user'?'justify-end':'justify-start'}`;div.innerHTML=`<div class="max-w-[80%] px-3 py-2 shadow-sm text-sm ${role==='user'?'chat-msg-user':'chat-msg-ai'}">${text}</div>`;container.appendChild(div);container.scrollTop=container.scrollHeight;}
async function triggerAI(){if(!config.apiKey)return alert("è¯·å…ˆé…ç½® API Key");const btn=document.getElementById('gen-btn');btn.innerText="å¯¹æ–¹æ­£åœ¨è¾“å…¥...";btn.disabled=true;const contextMsg=[{role:'system',content:`${config.systemPrompt} å½“å‰ç¯å¢ƒï¼š${config.city}, å¤©æ°”${config.weather}, æ—¶é—´${new Date().toLocaleString()}`},...chatHistory.slice(-5)];try{const response=await fetch(`${config.baseUrl}/chat/completions`,{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${config.apiKey}`},body:JSON.stringify({model:config.model,messages:contextMsg,max_tokens:100})});const data=await response.json();const reply=data.choices[0].message.content;const parts=reply.split(/[ï¼Œã€‚ï¼ï¼Ÿ]/).filter(p=>p.length>0);for(let part of parts){await new Promise(r=>setTimeout(r,800));renderMsg(part.substring(0,20),'assistant');chatHistory.push({role:'assistant',content:part.substring(0,20)});}}catch(e){renderMsg("ï¼ˆæ¶ˆæ¯å‘é€å¤±è´¥ï¼Œè¯·æ£€æŸ¥é…ç½®ï¼‰",'assistant');}finally{btn.innerText="ç‚¹å‡»ç”Ÿæˆå¯¹æ–¹å›å¤";btn.disabled=false;}}
</script>

</body>
</html>
