<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>AI Mobile OS</title>
<script src="https://cdn.tailwindcss.com"></script>

<style id="custom-style">
body { background: #f0f0f0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
.glass-card { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); border-radius: 24px; }
.app-icon { width: 60px; height: 60px; background: white; border-radius: 15px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
.chat-msg-user { background: #95ec69; border-radius: 6px 0 6px 6px; }
.chat-msg-ai { background: white; border-radius: 0 6px 6px 6px; }

.widget-card{
width:100%;
border-radius:28px;
padding:20px;
background:linear-gradient(135deg,#ffffff,#f3f4f6);
box-shadow:0 8px 20px rgba(0,0,0,0.08);
position:relative;
}
.widget-avatar{
width:60px;height:60px;border-radius:50%;object-fit:cover;
border:3px solid white;box-shadow:0 4px 10px rgba(0,0,0,0.1);
}
.widget-emoji{font-size:14px;cursor:pointer;}
.widget-text{
position:absolute;bottom:15px;right:20px;
font-size:12px;color:#555;cursor:pointer;
}
</style>
</head>

<body class="h-screen overflow-hidden flex flex-col">

<!-- ===================== é¦–é¡µ ===================== -->
<div id="home-screen" class="flex-1 p-6 flex flex-col items-center">

<!-- ä½ åŸæœ‰å†…å®¹å…¨éƒ¨ä¿ç•™ -->

</div>

<!-- ===================== è®ºå›ç•Œé¢ ===================== -->
<div id="forum-screen" class="fixed inset-0 bg-white hidden flex flex-col z-50">

<div class="h-12 bg-white flex items-center px-4 border-b relative">
<button onclick="closeForum()" class="text-xl">ã€ˆ</button>
<div class="flex-1 text-center font-bold">è®ºå›</div>
<button onclick="generateForumPosts()" class="absolute right-4 text-xl">ğŸ”„</button>
</div>

<div id="forum-flow" class="flex-1 overflow-y-auto p-4 space-y-4"></div>

<button onclick="openPost()"
class="fixed bottom-24 right-6 w-14 h-14 bg-black text-white text-3xl rounded-full shadow-lg flex items-center justify-center">
+
</button>

</div>

<!-- ===================== âœ… æ–°å¢ï¼šå‘å¸–ç•Œé¢ ===================== -->

<div id="post-screen" class="fixed inset-0 bg-white hidden flex flex-col z-[60]">

<!-- é¡¶æ  -->
<div class="h-12 flex items-center px-4 border-b relative">
<button onclick="closePost()" class="text-xl">ã€ˆ</button>
<div class="flex-1 text-center font-bold">å‘å¸–</div>

<button onclick="submitPost()"
class="absolute right-4 px-3 py-1 rounded-xl bg-gray-200">
<span class="text-gray-800 font-medium text-sm">å‘å¸ƒ</span>
</button>
</div>

<!-- å†…å®¹ -->
<div class="flex-1 overflow-y-auto p-4 space-y-4">

<textarea id="post-text"
placeholder="åˆ†äº«ç‚¹ä»€ä¹ˆå§..."
class="w-full h-32 resize-none outline-none text-sm"></textarea>

<div id="image-preview" class="flex flex-wrap gap-3"></div>

<label class="w-24 h-24 border-2 border-dashed border-gray-300
rounded-xl flex items-center justify-center text-gray-400 text-2xl cursor-pointer">
+
<input type="file" id="image-input" multiple accept="image/*" class="hidden">
</label>

</div>
</div>

<script>

/* ================= åŸæœ‰å˜é‡å…¨éƒ¨ä¿ç•™ ================= */

let config={baseUrl:'https://api.openai.com/v1',apiKey:'',model:'gpt-3.5-turbo',customCss:'',systemPrompt:'ä½ æ˜¯ä¸€ä¸ªçœŸå®çš„å¾®ä¿¡å¥½å‹ï¼Œå›å¤æç®€ï¼Œæ§åˆ¶åœ¨20å­—å†…ã€‚'};
let chatHistory=[];
let forumPosts=[];

/* ================= åŸæœ‰åŠŸèƒ½ ================= */

function openForum(){document.getElementById('forum-screen').classList.remove('hidden');}
function closeForum(){document.getElementById('forum-screen').classList.add('hidden');}
function openChat(){document.getElementById('chat-screen').classList.remove('hidden');}
function closeChat(){document.getElementById('chat-screen').classList.add('hidden');}

/* ================= å‘å¸–ç•Œé¢é€»è¾‘ï¼ˆæ–°å¢ï¼‰ ================= */

let selectedImages=[];

function openPost(){
document.getElementById("post-screen").classList.remove("hidden");
}

function closePost(){
document.getElementById("post-screen").classList.add("hidden");
document.getElementById("post-text").value="";
selectedImages=[];
document.getElementById("image-preview").innerHTML="";
}

document.getElementById("image-input")?.addEventListener("change",function(e){
const files=e.target.files;
for(let file of files){
const reader=new FileReader();
reader.onload=function(event){
selectedImages.push(event.target.result);
renderPreview();
};
reader.readAsDataURL(file);
}
});

function renderPreview(){
const container=document.getElementById("image-preview");
container.innerHTML="";
selectedImages.forEach((src,index)=>{
const div=document.createElement("div");
div.className="relative w-24 h-24";
div.innerHTML=`
<img src="${src}" class="w-full h-full object-cover rounded-xl">
<button onclick="removeImage(${index})"
class="absolute -top-2 -right-2 bg-black text-white w-5 h-5 text-xs rounded-full">Ã—</button>
`;
container.appendChild(div);
});
}

function removeImage(index){
selectedImages.splice(index,1);
renderPreview();
}

function submitPost(){
const text=document.getElementById("post-text").value.trim();

if(!text && selectedImages.length===0){
alert("è¯·è¾“å…¥å†…å®¹æˆ–æ·»åŠ å›¾ç‰‡");
return;
}

forumPosts.unshift({
title: text ? text.substring(0,20) : "å›¾ç‰‡åˆ†äº«",
content: text,
images: selectedImages
});

renderForum();
closePost();
}

/* ================= ğŸ”¥ æ›¿æ¢ä½ åŸæ¥çš„ renderForum ================= */

function renderForum(){
const container=document.getElementById("forum-flow");
container.innerHTML="";

forumPosts.forEach(post=>{
const div=document.createElement("div");
div.className="p-4 bg-gray-100 rounded-xl shadow-sm space-y-2";

let imagesHtml="";
if(post.images){
imagesHtml=post.images.map(src=>
`<img src="${src}" class="w-full rounded-lg">`
).join("");
}

div.innerHTML=`
<h3 class="font-bold">${post.title}</h3>
<p class="text-sm text-gray-600">${post.content || ""}</p>
${imagesHtml}
`;

container.appendChild(div);
});
}

/* ================= åŸæœ‰è®ºå›ç”Ÿæˆä¸åŠ¨ ================= */

function generateForumPosts(){
if(!config.apiKey){alert("è¯·å…ˆå¡«å†™API Key");return;}
const count=Math.floor(Math.random()*6)+10;
const promptText=`ç”Ÿæˆ${count}æ¡çœŸå®ç½‘å‹è®ºå›å¸–å­ï¼ŒJSONæ•°ç»„æ ¼å¼ï¼Œæ¯æ¡åŒ…å«titleå’Œcontentã€‚ä¸è¦è§£é‡Šã€‚`;

fetch(`${config.baseUrl}/chat/completions`,{
method:'POST',
headers:{'Content-Type':'application/json','Authorization':`Bearer ${config.apiKey}`},
body:JSON.stringify({
model:config.model,
messages:[{role:"user",content:promptText}],
temperature:0.9
})
})
.then(res=>res.json())
.then(data=>{
const json=JSON.parse(data.choices[0].message.content);
forumPosts=json;
renderForum();
})
.catch(()=>alert("ç”Ÿæˆå¤±è´¥"));
}

</script>

</body>
</html>
